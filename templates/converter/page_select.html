{% extends "base.html" %}

{% block content %}
<div class="page-grid">
  {% for thumbnail in thumbnails %}
  <div class="page-item" data-page="{{ forloop.counter0 }}">
    <img src="{{ thumbnail.url }}" alt="Page {{ forloop.counter }}">
    <button class="delete-btn">âœ•</button>
  </div>
  {% endfor %}
</div>

<form method="post" id="pageForm">
  {% csrf_token %}
  <input type="hidden" name="delete_pages" id="deletePagesInput">
  <button type="submit">Continue</button>
</form>

<script>
  // JavaScript to handle page deletion
  document.querySelectorAll('.delete-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const pageItem = btn.closest('.page-item');
      const pageIndex = pageItem.dataset.page;
      
      // Toggle deletion UI
      pageItem.classList.toggle('deleted');
      
      // Update hidden input value
      const deletedPages = new Set(
        document.getElementById('deletePagesInput').value.split(',')
      );
      
      if (deletedPages.has(pageIndex)) {
        deletedPages.delete(pageIndex);
      } else {
        deletedPages.add(pageIndex);
      }
      
      document.getElementById('deletePagesInput').value = 
        Array.from(deletedPages).join(',');
    });
  });
</script>
{% endblock %}